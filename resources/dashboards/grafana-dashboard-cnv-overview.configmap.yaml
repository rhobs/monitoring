apiVersion: v1
data:
  cnv-cluster-overview.json: |-
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": {
              "uid": "-- Grafana --"
            },
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "target": {
              "limit": 100,
              "matchAny": false,
              "tags": [],
              "type": "dashboard"
            },
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 0,
      "id": null,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 50,
          "panels": [],
          "title": "Cluster Info",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 4,
            "x": 0,
            "y": 1
          },
          "id": 46,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sum(cnv:vmi_status_running:count $source)",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Running VMs",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 11,
            "w": 5,
            "x": 4,
            "y": 1
          },
          "id": 97,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc ((count by (version) (csv_succeeded{name=~\".*hyperconverged.*\"} $source)) > 5)",
              "hide": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "B"
            }
          ],
          "title": "Clusters by Version",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 11,
            "w": 5,
            "x": 9,
            "y": 1
          },
          "id": 105,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc ((count by (major_minor_version) (label_replace(\n  csv_succeeded{name=~\".*hyperconverged.*\"},\n  \"major_minor_version\",\n  \"$1.$2\",  # Replacement format to keep only Major and Minor version numbers.\n  \"version\",\n  \"(\\\\d+)\\\\.(\\\\d+)\\\\..*\"  # Regex to match and capture Major and Minor version numbers.\n)\n $source)) > 5)",
              "hide": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "B"
            }
          ],
          "title": "Clusters by Minor Version",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 50,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "stepAfter",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "normal"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "links": [],
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 11,
            "w": 5,
            "x": 14,
            "y": 1
          },
          "id": 86,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "multi",
              "sort": "desc"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc ((count by (version) (csv_succeeded{name=~\".*hyperconverged.*\"} $source)) > 5)",
              "format": "time_series",
              "instant": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{version}}",
              "refId": "A"
            }
          ],
          "title": "Clusters by Version",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 11,
            "w": 5,
            "x": 19,
            "y": 1
          },
          "id": 100,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count by (channel)(label_replace(subscription_sync_total{installed=~\".*hyperconverged.*\"}, \"channel\", \"none\", \"channel\", \"\") $source) ",
              "hide": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "B"
            }
          ],
          "title": "Clusters by Channel",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 4,
            "x": 0,
            "y": 4
          },
          "id": 106,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count(count by(_id)(subscription_sync_total{installed=~\".*hyperconverged.*\"} $source))\n",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters with CNV",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 4,
            "x": 0,
            "y": 7
          },
          "id": 95,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count (\n    count by (ebs_account)\n    (\n      (subscription_sync_total{installed=~\".*hyperconverged.*\"} $source)\n      + on (_id) group_left(ebs_account)\n      (0 * topk by (_id) (1, ocm_subscription{}))\n    )\n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Accounts with CNV",
          "type": "stat"
        },
        {
          "datasource": {
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 10,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "links": [],
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 12
          },
          "id": 79,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "multi",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "expr": "count (subscription_sync_total{installed=~\".*hyperconverged.*\"} $source)",
              "instant": false,
              "interval": "",
              "legendFormat": "HCO Installations",
              "refId": "A"
            }
          ],
          "title": "Clusters over time",
          "type": "timeseries"
        },
        {
          "datasource": {
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 10,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "links": [],
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 12
          },
          "id": 62,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "multi",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "expr": "sum(cnv:vmi_status_running:count $source)",
              "instant": false,
              "interval": "",
              "legendFormat": "Number of Running VMs",
              "refId": "A"
            }
          ],
          "title": "Running VMs over time",
          "type": "timeseries"
        },
        {
          "datasource": {
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "decimals": 2,
              "displayName": "",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Time"
                },
                "properties": [
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "_0_email_domain"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Email Domain"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value #B"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "CPU Cores"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value #D"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Clusters Count"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value #C"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Memory"
                  },
                  {
                    "id": "unit",
                    "value": "decbytes"
                  },
                  {
                    "id": "decimals",
                    "value": 2
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value #A"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "# of Running VMs"
                  },
                  {
                    "id": "unit",
                    "value": "short"
                  },
                  {
                    "id": "decimals",
                    "value": 2
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "ebs_account"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "EBS Account"
                  },
                  {
                    "id": "unit",
                    "value": "short"
                  },
                  {
                    "id": "decimals",
                    "value": 2
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 19
          },
          "id": 72,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "expr": "sort_desc\n(\n sum by (_0_email_domain, ebs_account)\n (\n   cnv:vmi_status_running:count $source\n   + on (_id) group_left(_0_email_domain, ebs_account)\n   ( 0 * topk by (_id) (1, label_replace(ocm_subscription,\"_0_email_domain\", \"$1\", \"email_domain\", \"(.*)\")) )\n )>0\n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            },
            {
              "datasource": {
                "uid": "$datasource"
              },
              "expr": "sort_desc\n(\n  sum by (_0_email_domain, ebs_account)(\n         sum by (_id) (cluster:capacity_cpu_cores:sum $source)\n         + on (_id) group_left(_blah)\n         ( 0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}) )\n         + on (_id) group_left(_0_email_domain, ebs_account)\n         ( 0 * topk by (_id) (1, label_replace(ocm_subscription,\"_0_email_domain\", \"$1\", \"email_domain\", \"(.*)\")) )\n         + on (_id) group_left(_blah)\n         ( 0 * group by (_id)(cnv:vmi_status_running:count))\n )\n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "legendFormat": "",
              "refId": "B"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "$datasource"
              },
              "expr": "sort_desc\n(\n  sum by (_0_email_domain, ebs_account)( \n         sum by (_id) (cluster:capacity_memory_bytes:sum $source)\n         + on (_id) group_left(_blah)\n         ( 0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}) )\n         + on (_id) group_left(_0_email_domain, ebs_account)\n         ( 0 * topk by (_id) ( 1, label_replace(ocm_subscription{},\"_0_email_domain\", \"$1\", \"email_domain\", \"(.*)\")) )\n         + on (_id) group_left(_blah)\n         ( 0 * group by (_id)(cnv:vmi_status_running:count))\n )\n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "legendFormat": "",
              "refId": "C"
            },
            {
              "datasource": {
                "uid": "$datasource"
              },
              "expr": "sort_desc\n    (\n      sum by (_0_email_domain, ebs_account)(\n      1 + 0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"})\n      + on (_id) group_left(_blah) (0 * group by (_id, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal=\"\"}))\n       + on (_id) group_left(_0_email_domain, ebs_account)( 0 * topk by (_id) (1, label_replace(ocm_subscription{},\"_0_email_domain\", \"$1\", \"email_domain\", \"(.*)\") ) ) \n       + on (_id) group_left(_blah)( 0 * group by (_id)(cnv:vmi_status_running:count)))   \n     )",
              "format": "table",
              "instant": true,
              "interval": "",
              "legendFormat": "",
              "refId": "D"
            }
          ],
          "title": "Number of running VMs, Memory, cluster count and CPU Cores By account and email domain",
          "transformations": [
            {
              "id": "merge",
              "options": {
                "reducers": []
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PD776AFABBE26000A"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Time"
                },
                "properties": [
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "_0_email_domain"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Email Domain"
                  },
                  {
                    "id": "unit",
                    "value": "short"
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "ebs_account"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "EBS Account"
                  },
                  {
                    "id": "unit",
                    "value": "short"
                  },
                  {
                    "id": "decimals",
                    "value": 2
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 19
          },
          "id": 83,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc\n(\n count by (_0_email_domain, ebs_account)\n (\n   (\n     subscription_sync_total{installed=~\".*hyperconverged.*\"} $source\n   )\n   + on (_id) group_left(_0_email_domain, ebs_account)\n   ( 0 * topk by (_id) (1, label_replace(ocm_subscription{},\"_0_email_domain\", \"$1\", \"email_domain\", \"(.*)\")  )  ) \n )\n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Number of OLM subscriptions by email domain and account",
          "transformations": [
            {
              "id": "merge",
              "options": {
                "reducers": []
              }
            }
          ],
          "type": "table"
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 28
          },
          "id": 114,
          "panels": [],
          "title": "Cluster Network Info",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Number of CNV clusters that have at least one instance (pods and/or vms) annotated with k8s.v1.cni.cncf.io/networks. ",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 29
          },
          "id": 112,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count(count by (_id) (cluster:network_attachment_definition_instances:max $source + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))))",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters with Additional Network",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Number of CNV clusters that have instances (pods and/or vms) annotated with k8s.v1.cni.cncf.io/networks, by network name.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "mappings": [],
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "B"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "bridge|cnv-bridge"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "C"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "tuning|cnv-tuning"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "D"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "sriov|ib-sriov"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 12,
            "w": 9,
            "x": 6,
            "y": 29
          },
          "id": 108,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (count by (networks) (count by (networks, _id)\n  ((cluster:network_attachment_definition_instances:max{networks=~\"^[^,]*$\", networks!~\"any|bridge|cnv-bridge|tuning|cnv-tuning|sriov|ib-sriov\"} $source)\n  + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))\n)))",
              "hide": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "A"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": " count (count by (_id)\n  ((cluster:network_attachment_definition_instances:max{networks=~\"bridge|cnv-bridge\"} $source)\n  + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))\n))",
              "hide": false,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "B"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": " count (count by (_id)\n  ((cluster:network_attachment_definition_instances:max{networks=~\"tuning|cnv-tuning\"} $source)\n  + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))\n))",
              "hide": false,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "C"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": " count (count by (_id)\n  ((cluster:network_attachment_definition_instances:max{networks=~\"sriov|ib-sriov\"} $source)\n  + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))\n))",
              "hide": false,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "D"
            }
          ],
          "title": "Clusters by Additional Network Name",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Number of CNV clusters by that have instances (pods and/or VMs) with 2 or more network names annotated with k8s.v1.cni.cncf.io/networks, by networks names.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "mappings": [],
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 9,
            "x": 15,
            "y": 29
          },
          "id": 115,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (count by (networks) (count by (networks, _id)\n  ((cluster:network_attachment_definition_instances:max{networks=~\".*,.*\"} $source)\n  + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))\n)))",
              "hide": false,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Clusters by Multiple Additional Networks Names",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Number of CNV clusters that do not have any instances (pods and/or vms) annotated with k8s.v1.cni.cncf.io/networks.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 32
          },
          "id": 111,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "(count(count by(_id)(subscription_sync_total{installed=~\".*hyperconverged.*\"} $source))) - (count(count by (_id) ((cluster:network_attachment_definition_instances:max $source + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))))))\n",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters without Additional Networks",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Percentage of CNV clusters that have at least one instance (pods and/or vms) annotated with k8s.v1.cni.cncf.io/networks. ",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 35
          },
          "id": 119,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "(count(count by (_id) (cluster:network_attachment_definition_instances:max $source + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))))) / (count(count by(_id)(subscription_sync_total{installed=~\".*hyperconverged.*\"} $source)))",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters with Additional Network %",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Percentage of CNV clusters that do not have any instances (pods and/or vms) annotated with k8s.v1.cni.cncf.io/networks.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "text": "N/A"
                    }
                  },
                  "type": "special"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 38
          },
          "id": 118,
          "maxDataPoints": 100,
          "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "((count(count by(_id)(subscription_sync_total{installed=~\".*hyperconverged.*\"} $source))) - (count(count by (_id) ((cluster:network_attachment_definition_instances:max $source + on(_id) group_left(_blah) (0 * group by (_id) (subscription_sync_total{installed=~\".*hyperconverged.*\"}))))))) / (count(count by(_id)(subscription_sync_total{installed=~\".*hyperconverged.*\"} $source)))\n",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters without Additional Networks %",
          "type": "stat"
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 41
          },
          "id": 99,
          "panels": [],
          "title": "Virtual Machins Details",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the OSs distribution, for all running VMs that include the os label , that was introduced in OCP 4.8.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 6,
            "x": 0,
            "y": 42
          },
          "id": 59,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (os) (cnv:vmi_status_running:count{os=\"<none>\"} $source))",
              "format": "time_series",
              "hide": false,
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "Unknown",
              "refId": "A"
            },
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (os) (cnv:vmi_status_running:count{os!=\"\",os!=\"<none>\"} $source))",
              "hide": false,
              "instant": true,
              "interval": "",
              "legendFormat": "{{os}}",
              "refId": "B"
            }
          ],
          "title": "Operating System Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the flavors distribution, for all running VMs that include the flavor label , that was introduced in OCP 4.8.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 6,
            "x": 6,
            "y": 42
          },
          "id": 87,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (flavor) (cnv:vmi_status_running:count{flavor=\"<none>\"} $source))",
              "format": "time_series",
              "hide": false,
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "Unknown",
              "refId": "A"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (flavor) (cnv:vmi_status_running:count{flavor!=\"\",flavor!=\"<none>\"} $source))",
              "hide": false,
              "instant": true,
              "interval": "",
              "legendFormat": "{{flavor}}",
              "refId": "B"
            }
          ],
          "title": "Flavor Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the OSs distribution, for all running VMs that include the os label , that was introduced in OCP 4.8.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 6,
            "x": 12,
            "y": 42
          },
          "id": 88,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (workload) (cnv:vmi_status_running:count{workload=\"<none>\"} $source))",
              "format": "time_series",
              "hide": false,
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "Unknown",
              "refId": "A"
            },
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (workload) (cnv:vmi_status_running:count{workload!=\"\",workload!=\"<none>\"} $source))",
              "hide": false,
              "instant": true,
              "interval": "",
              "legendFormat": "{{workload}}",
              "refId": "B"
            }
          ],
          "title": "Workload Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the cluster host type distribution, for clusters with running VMs.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 6,
            "x": 18,
            "y": 42
          },
          "id": 91,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count by (host_type) (count by (_id,host_type) (id_primary_host_type)\n+ on (_id) group_left(_blah) (0 * group by (_id) (cnv:vmi_status_running:count) $source))",
              "hide": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "B"
            }
          ],
          "title": "Host Type Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the guest OS name distribution. This information was introduced in CNV v4.16.0, for all running VMs that have the guest agent installed.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 6,
            "x": 6,
            "y": 50
          },
          "id": 103,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (guest_os_name)(cnv:vmi_status_running:count{guest_os_name!=\"\", guest_os_name!=\"<none>\"} $source))",
              "hide": false,
              "instant": true,
              "interval": "",
              "legendFormat": "__auto",
              "refId": "B"
            }
          ],
          "title": "Guest OS Name Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the instance types distribution, for all running VMs that include the instance type annotation.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 6,
            "x": 12,
            "y": 50
          },
          "id": 113,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (instance_type) (cnv:vmi_status_running:count{instance_type!=\"\",instance_type!=\"<none>\", instance_type!=\"<other>\"} $source))",
              "hide": false,
              "instant": true,
              "interval": "",
              "legendFormat": "{{workload}}",
              "refId": "B"
            }
          ],
          "title": "Instance Type Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This panel shows the preferences distribution, for all running VMs that include the preference annotation.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "decimals": 0,
              "mappings": [],
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 6,
            "x": 18,
            "y": 50
          },
          "id": 102,
          "maxDataPoints": 3,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "values": [
                "value",
                "percent"
              ]
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (preference) (cnv:vmi_status_running:count{preference!=\"\",preference!=\"<none>\", preference!=\"<other>\"} $source))",
              "hide": false,
              "instant": true,
              "interval": "",
              "legendFormat": "{{workload}}",
              "refId": "B"
            }
          ],
          "title": "Preference Distribution",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "This table shows a list of guest OSs name and Version ID. This information was introduced in CNV v4.16.0, for all running VMs that have the guest agent installed.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "decimals": 2,
              "displayName": "",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Time"
                },
                "properties": [
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 59
          },
          "id": 104,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (guest_os_name, guest_os_version_id)(cnv:vmi_status_running:count{guest_os_name!=\"\", guest_os_name!=\"<none>\"} $source))",
              "instant": true,
              "interval": "",
              "legendFormat": "Guest OS Name: {{guest_os_name}}, Guest OS Version ID: {{guest_os_version_id}}",
              "refId": "D"
            }
          ],
          "title": "Guest OS Name and Version ID",
          "transformations": [
            {
              "id": "seriesToRows",
              "options": {
                "reducers": []
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "decimals": 2,
              "displayName": "",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Time"
                },
                "properties": [
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 59
          },
          "id": 73,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sort_desc (sum by (os,flavor,workload) (cnv:vmi_status_running:count{os!=\"\",os!=\"<none>\",flavor!=\"\",flavor!=\"<none>\",workload!=\"\",workload!=\"<none>\" } $source))",
              "instant": true,
              "interval": "",
              "legendFormat": "OS: {{os}}, Flavor: {{flavor}}, Workload: {{workload}}",
              "refId": "D"
            }
          ],
          "title": "VM Templates",
          "transformations": [
            {
              "id": "seriesToRows",
              "options": {
                "reducers": []
              }
            }
          ],
          "type": "table"
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 68
          },
          "id": 64,
          "panels": [],
          "title": "Health",
          "type": "row"
        },
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 69
          },
          "id": 66,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "\n### CSV Condition Reasons\n\nThe following table provides a short description of what the condition means:\n\n\n| **Condition Reason**                        | **Explanation for Telemetry**                                                                                                                              | **Operator is running**                 |\n| ------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |\n| RequirementsUnknown                         | OLM hasn't gotten around to checking for requirements yet                                                                                                  | no                                      |\n| RequirementsNotMet                          | One or more requirements to install haven't been met (crds, nativeapis, apis, serviceaccount, rbac)                                                        | no                                      |\n| AllRequirementsMet                          | The Operator is currently installing and all of its requirements have been met                                                                             | No (installing)                         |\n| OwnerConflict                               | Two operators own the same apis in the namespace, but are not connected via a chain of \"replaces\" (rare, mostly caused by a bug in 4.2)                    | no                                      |\n| InstallComponentFailed                      | Failed to create a component that makes up the Operator: deployment, CRD, RBAC apiservices, etc.                                                           | no                                      |\n| InvalidInstallStrategy                      | The install strategy for a csv is not in the format we expect.                                                                                             | no                                      | \n| InstallWaiting                              | Install is progressing and OLM is waiting for components to come online.                                                                                   | No (Installing)                         |\n| InstallSucceeded                            | The operator's deployments are all ready/available.                                                                                                        | yes                                     |\n| InstallCheckFailed                          | The operator never became healthy, OLM now treats the operator as failed.                                                                                  | no                                      |\n| ComponentUnhealthy                          | Some requirement or component is not in the state it should be, the Operator will be flipped back in an attempt to recreate anything that belongs to it.   | likely no                               |\n| BeingReplaced                               | Operator is being updated                                                                                                                                  | yes                                     |\n| Replaced                                    | Operator has been updated and newer version is healthy                                                                                                     | yes                                     |\n| NeedsReinstall                              | Operator configuration got updated ( subscription.config, rotating certs, proxy config, etc) and the Operator needs to be redeployed with the new settings | yes                                     |\n| NeedsCertRotation                           | The certs will be rotated for an apiservice-based operator.                                                                                                | yes                                     |\n| APIServiceResourceIssue                     | A previously created resource required to deploy an extension apiserver has disappeared.                                                                   | likely no                               |\n| APIServiceResourcesNeedReinstall            | Some resources required to run extension apiservers were not in the expected state, OLM will attempt to recreate them.                                     | likely no                               |\n| APIServiceInstallFailed                     | Extension apiserver install has failed in a way that OLM can't recover.                                                                                    | no                                      |\n| Copied                                      | This CSV is a placeholder to indicate the operator is watching the current namespace.                                                                      | Yes (depends on the parent, \"real\" csv) |\n| InvalidInstallModes                         | The CSV contains improperly formatted installmodes (duplicate entries, typos, etc)                                                                         | no                                      |\n| NoTargetNamespaces                          | There are no namespaces resolved as target namespaces for the current operatorgroup.                                                                       | no                                      |\n| UnsupportedOperatorGroup                    | The current operatorgroup does not support the installmodes of the Operator.                                                                               | no                                      |\n| NoOperatorGroup                             | Operator cannot be installed because the namespace does not have an OperatorGroup.                                                                         | no                                      |\n| TooManyOperatorGroups                       | We currently only allow 1 OperatorGroup per namespace.                                                                                                     | no                                      |\n| InterOperatorGroupOwnerConflict             | The operator provides an API that another operator provides in the current namespace (i.e. it is provided in an operatorgroup that targets this namespace) | no                                      |\n| CannotModifyStaticOperatorGroupProvidedAPIs | A CSV is present in an operatorgroup with \"static\" provided apis set and provides apis not in the set.                                                     |                                         |",
            "mode": "markdown"
          },
          "pluginVersion": "11.6.3",
          "title": "README.md",
          "type": "text"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PD776AFABBE26000A"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "links": [],
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 76
          },
          "id": 75,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count by (phase, reason) (csv_abnormal{name=~\".*hyperconverged.*\", phase=~\"Pending|Failed\"} $source )",
              "instant": false,
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Number of OLM CSVs install/upgrade failures",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "description": "Clusters with CSV issues in the last 1 Hour and the value indicates the time they have this issue.\n\nNote: The max value van be up to 3 weeks, depending that we have 3 weeks of data.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "decimals": 2,
              "displayName": "",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Time"
                },
                "properties": [
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Issue Duration"
                  },
                  {
                    "id": "unit",
                    "value": "d"
                  },
                  {
                    "id": "decimals",
                    "value": 2
                  },
                  {
                    "id": "custom.align"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 85
          },
          "id": 92,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "sum by (_id,name,phase,reason, email_domain) (\n count_over_time(csv_abnormal{name=~\".*hyperconverged.*\", phase=~\"Pending|Failed\"}[1h])\n  + on (_id) group_left(email_domain)\n  ( 0 * topk by (_id) (1, ocm_subscription{} ))\n  $source \n) * 0 \n+ on (_id,name,phase,reason) group_left(_blah) (\nsum by (_id,name,phase,reason, email_domain) (\ncount_over_time(csv_abnormal{name=~\".*hyperconverged.*\", phase=~\"Pending|Failed\"}[3w:1d])\n  $source \n)\n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters with OLM CSVs issues in the last 1 hour",
          "transformations": [
            {
              "id": "merge",
              "options": {
                "reducers": []
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PD776AFABBE26000A"
          },
          "description": "Could indicate update problems",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "decimals": 2,
              "displayName": "",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Time"
                },
                "properties": [
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "short"
                  },
                  {
                    "id": "custom.align"
                  },
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 93
          },
          "id": 94,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true
          },
          "pluginVersion": "11.6.3",
          "targets": [
            {
              "datasource": {
                "uid": "$datasource"
              },
              "editorMode": "code",
              "expr": "count by (_id,name,phase,reason, email_domain) (\n  csv_abnormal{name=~\".*hyperconverged.*\", phase=~\"Pending|Failed\"} \n  + on (_id) group_left(email_domain)\n  ( 0 * topk by (_id) (1, ocm_subscription{} ))\n  $source \n)",
              "format": "table",
              "instant": true,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "title": "Clusters with abnormal OLM CSVs",
          "transformations": [
            {
              "id": "merge",
              "options": {
                "reducers": []
              }
            }
          ],
          "type": "table"
        }
      ],
      "preload": false,
      "refresh": "",
      "schemaVersion": 41,
      "tags": [],
      "templating": {
        "list": [
          {
            "current": {
              "text": "telemeter-recent-production",
              "value": "PD776AFABBE26000A"
            },
            "includeAll": false,
            "name": "datasource",
            "options": [],
            "query": "prometheus",
            "refresh": 1,
            "regex": "telemeter-recent-production",
            "type": "datasource"
          },
          {
            "current": {
              "text": "+ on (_id) group_left(_blah) (0 * group by (_id, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal=\"\"}))",
              "value": "+ on (_id) group_left(_blah) (0 * group by (_id, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal=\"\"}))"
            },
            "includeAll": false,
            "name": "source",
            "options": [
              {
                "selected": false,
                "text": "All",
                "value": "+ 0"
              },
              {
                "selected": true,
                "text": "External (!RH,!IBM)",
                "value": "+ on (_id) group_left(_blah) (0 * group by (_id, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal=\"\"}))"
              },
              {
                "selected": false,
                "text": "Internal (RH,IBM)",
                "value": "+ on (_id) group_left(_blah) (0 * group by (_id, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal!=\"\"}))"
              }
            ],
            "query": "All : + 0, External (!RH\\,!IBM) : + on (_id) group_left(_blah) (0 * group by (_id\\, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal=\"\"})), Internal (RH\\,IBM) : + on (_id) group_left(_blah) (0 * group by (_id\\, email_domain) (id_version_ebs_account_internal:cluster_subscribed{internal!=\"\"}))",
            "type": "custom"
          }
        ]
      },
      "time": {
        "from": "now-7d",
        "to": "now"
      },
      "timepicker": {},
      "timezone": "",
      "title": "CNV - Cluster Overview",
      "uid": "CNVClusterOverview",
      "version": 1
    }
kind: ConfigMap
metadata:
  name: grafana-dashboard-cnv-cluster-overview
  labels:
    grafana_dashboard: "true"
  annotations:
    grafana-folder: /grafana-dashboard-definitions/CNV